<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hellper Catalogue</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script type='text/javascript'
        src='https://platform-api.sharethis.com/js/sharethis.js#property=65a54943fbfe1600199c5bfb&product=sop'
        async='async'></script>
    <link rel="icon" href="./media/image/FavIcon.png" type="image/x-icon">
    <link rel="shortcut icon" href="./media/image/FavIcon.png" type="image/x-icon">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.71/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.71/vfs_fonts.js"></script>

</head>

<body>
    <div class="header" id="header">
        <div class="header_left">
            <a href="https://www.javiddo.com/p/hellper"><img src="./media/svg/slogan all.svg"
                    alt="Hellper Javiddo Group"></a>
        </div>
        <div class="header_right">
            <p class="spare_parts_name">BRAKE PAD</p>
            <img class="spare_parts_picture" src="./media/image/Spare Parts.png" alt="">
        </div>
    </div>


    <h2></h2>
    <div id="table-container" style=" width: 100%; align-items: center; justify-content: center; display: flex;"></div>

    <script>
        // Путь к вашему Excel-файлу
        var excelFilePath = './DataBase/TestDataBase.xlsx';

        var req = new XMLHttpRequest();
        req.open('GET', excelFilePath, true);
        req.responseType = 'arraybuffer';

        req.onload = function (e) {
            var data = new Uint8Array(req.response);
            var workbook = XLSX.read(data, { type: 'array' });
            var jsonData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            document.getElementById('table-container').innerHTML = jsonToTable(jsonData);
        };

        req.send();

        function jsonToTable(jsonData) {
            var table = '<table>';
            table += '<tr>';
            for (var key in jsonData[0]) {
                table += '<th>' + key + '</th>';
            }
            table += '</tr>';

            for (var i = 0; i < jsonData.length; i++) {
                table += '<tr>';
                for (var key in jsonData[i]) {
                    table += '<td>' + jsonData[i][key] + '</td>';
                }
                table += '</tr>';
            }
            table += '</table>';

            return table;
        }

    </script>
    <div class="page_up"><a style="transition: 10s; margin: auto;" href="#top"><img src="./media/svg/page_up.svg"
                alt="Page Up Hellper Javiddo"></a>
    </div>
    <div class="red_line"></div>
    <div class="footer">

        <div class="footer_left">
            <a class="left_nav_bar" href="https://www.javiddo.com/p/catalog">
                <div><img src="./media/svg/LeftArrow.svg" alt="Back Page Hellper Javiddo Spare Parts"></div>
            </a>
            <a class="left_nav_bar" href="https://www.javiddo.com/p/catalog">
                <div><img src="./media/svg/HomePage.svg" alt="Home Page Hellper Javiddo Spare Parts"></div>
            </a>
            <a class="left_nav_bar" href="./Pages/book.html">
                <div><img src="./media/svg/Book.svg" alt="Book Page Hellper Javiddo Spare Parts"></div>
            </a>
        </div>


        <div class="footer_right">
            <a href="./Pages/tour.html" class="right_nav_bar">
                <img style="width: 27px;" src="./media/svg/360-degrees.svg"
                    alt="360 Room Tour Javiddo Hellper Spare Part">
            </a>
            <a href="https://www.javiddo.com/contact" class="right_nav_bar">
                <img src="./media/svg/Phone.svg" alt="Contact Us Javiddo Hellper Spare Part">
            </a>

            <a onclick="convertExcelToPDF()" class="right_nav_bar">
                <img src="./media/svg/Download.svg" alt="Download Javiddo Hellper Spare Part">
            </a>
        </div>
        <!-- <script>
            // JavaScript для обработки события нажатия на кнопку
            document.getElementById('DownloadPDF').addEventListener('click', function () {
                window.print(); // Запуск операции печати страницы
            });
        </script> -->
    </div>


    <script>
        function convertExcelToPDF() {
            var excelFilePath = './DataBase/TestDataBase.xlsx';

            var reader = new FileReader();

            reader.onload = function (e) {
                var data = new Uint8Array(e.target.result);
                var workbook = XLSX.read(data, { type: 'array' });
                var firstSheetName = workbook.SheetNames[0];
                var ws = workbook.Sheets[firstSheetName];
                var jsonData = XLSX.utils.sheet_to_json(ws, { header: 1 });

                // Обработка данных
                var cleanedData = removeEmptyCells(jsonData);

                // Генерация PDF
                var pdfDoc = {
                    content: [
                        {
                            table: {
                                headerRows: 1,
                                body: cleanedData
                            }
                        }
                    ]
                };

                pdfMake.createPdf(pdfDoc).download("converted_data.pdf");
            };

            fetch(excelFilePath)
                .then(response => response.arrayBuffer())
                .then(buffer => {
                    reader.readAsArrayBuffer(new Blob([buffer]));
                })
                .catch(error => console.error('Error fetching the Excel file:', error));
        }

        function removeEmptyCells(jsonData) {
            // Удаляем пустые ячейки из каждой строки данных
            var cleanedData = jsonData.map(row => row.filter(cell => cell !== undefined && cell !== null && cell !== ''));

            // Находим максимальное количество ячеек в строках после удаления пустых
            var maxCells = Math.max(...cleanedData.map(row => row.length));

            // Добавляем недостающие ячейки в каждую строку после удаления пустых
            cleanedData = cleanedData.map(row => {
                var diff = maxCells - row.length;
                if (diff > 0) {
                    return row.concat(Array(diff).fill(''));
                }
                return row;
            });

            return cleanedData;
        }
    </script>


</body>

</html>